---
interface Props {
  activeMenu?: string;
}

const { activeMenu } = Astro.props;

import { buildSearchIndex } from '../data/buildSearchIndex';

const searchIndex = await buildSearchIndex();
---

<div id="header-info" class="wrapper">
  <div class="container fullwidth">
    <ul>
      <li><span class="header-icon-pin"></span>88000 –£–∂–≥–æ—Ä–æ–¥, –£–∫—Ä–∞—ó–Ω–∞</li>
      <li>
        <span class="header-icon-mail"></span>
        <a href="mailto:aikidoaikikai.academy@gmail.com" class="link-style2">
          aikidoaikikai.academy@gmail.com
        </a>
      </li>
      <li>
        <span class="header-icon-phone"></span>
        <a href="tel:+380509314601" class="link-style2">
          +38 (050) 931 46 01
        </a>
      </li>
    </ul>
  </div>
</div>

<div id="header" class="wrapper">
  <div id="logo" class="container fullwidth" style="padding: 20px 0;">
    <a href="/"></a>
  </div>

  <div id="primary-navigation" class="container fullwidth">
    <a class="menu-responsive">
      <span class="menu-icon-nav"></span>
      <span class="menu-title">Navigation</span>
    </a>

    <ul class="menu clearfix">
      <li class:list={[{ selectedLava: activeMenu === 'home' }]}>
        <a class:list={[{ current: activeMenu === 'home' }]} href="/">
          <span class="menu-icon-home"></span>–ì–æ–ª–æ–≤–Ω–∞
        </a>
      </li>

      <li class:list={[{ selectedLava: activeMenu === 'about' }]}>
        <a class:list={[{ current: activeMenu === 'about' }]} href="/about">
          <span class="menu-icon-about"></span>–ü—Ä–æ –Ω–∞—Å
        </a>
      </li>

      <li>
        <a href="/video">
          <span class="menu-icon-features"></span>–í—ñ–¥–µ–æ
        </a>
      </li>

      <li>
        <a href="/blog">
          <span class="menu-icon-blog"></span>–ù–æ–≤–∏–Ω–∏
        </a>
      </li>

      <li>
        <a href="/rozklad-seminariv">
          –†–æ–∑–∫–ª–∞–¥ —Å–µ–º—ñ–Ω–∞—Ä—ñ–≤
        </a>
      </li>

      <li class:list={[{ selectedLava: activeMenu === 'contacts' }]}>
        <a class:list={[{ current: activeMenu === 'contacts' }]} href="/contacts">
          <span class="menu-icon-contact"></span>–ö–æ–Ω—Ç–∞–∫—Ç–∏
        </a>
      </li>

      <li class="menu-search">
        <a id="open-search" style="cursor:pointer;">
          üîç –ü–æ—à—É–∫
        </a>
      </li>
    </ul>

    <!-- –ü–æ—à—É–∫ -->
    <div id="search-box" class="search-box">
      <input
        type="text"
        id="search-input"
        placeholder="–ü–æ—à—É–∫ –ø–æ —Å–∞–π—Ç—É..."
        autocomplete="off"
      />
      <div id="search-results"></div>
    </div>
  </div>
</div>

<!-- –ü–µ—Ä–µ–¥–∞—î–º–æ —ñ–Ω–¥–µ–∫—Å —É –±—Ä–∞—É–∑–µ—Ä -->
 <>
<script is:inline define:vars={{ searchIndex }}>
  const SEARCH_INDEX = searchIndex;
</script>

<!-- –õ–æ–≥—ñ–∫–∞ –ø–æ—à—É–∫—É -->
<script is:inline define:vars={{ searchIndex }}>
  const btn = document.getElementById('open-search');
  const box = document.getElementById('search-box');
  const input = document.getElementById('search-input');
  const results = document.getElementById('search-results');

  const searchIndexData = searchIndex;

  btn?.addEventListener('click', () => {
    if (!box || !input) return;
    box.style.display = box.style.display === 'block' ? 'none' : 'block';
    input.focus();
  });

  input?.addEventListener('input', () => {
    if (!results || !input) return;

    const q = input.value.toLowerCase();
    results.innerHTML = '';

    if (q.length < 2) return;

    const filtered = searchIndexData.filter(item =>
      item.title.toLowerCase().includes(q) ||
      item.content.includes(q)
    );

    filtered.slice(0, 10).forEach(item => {
      const a = document.createElement('a');
      a.href = item.url;
      a.textContent = item.title;
      results.appendChild(a);
    });
  });
</script>
</>
